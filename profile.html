<!doctype html>
<html class="no-js" lang="zxx">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Online Voting</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

   <!-- CSS here -->
<link rel="stylesheet" href="css/styleprofile.css">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/owl.carousel.min.css">
    <link rel="stylesheet" href="css/magnific-popup.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <link rel="stylesheet" href="css/themify-icons.css">
    <link rel="stylesheet" href="css/nice-select.css">
    <link rel="stylesheet" href="css/flaticon.css">
    <link rel="stylesheet" href="css/gijgo.css">
    <link rel="stylesheet" href="css/animate.min.css">
    <link rel="stylesheet" href="css/slick.css">
    <link rel="stylesheet" href="css/slicknav.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/styleall.css">
    <!-- <link rel="stylesheet" href="css/responsive.css"> -->



</head>
<body>
   
    <!-- header-start -->
    <header>
        <div class="header-area ">
            <div id="sticky-header" class="main-header-area">
                <div  class="container-fluid">
                    <div class="row align-items-center">
                        <div class="col-xl-3 col-lg-2">
                            <div class="logo">
                                <a href="index.html">
                                  <h3 style="color:white;">Online Voting</h3>
                               
                                </a>
                            </div>
                        </div>
                        <div class="col-xl-6 col-lg-7">
                            <div class="main-menu  d-none d-lg-block">
                               <nav>
                                    <ul id="navigation">
                                        <li><a href="index.html">home</a></li>
                                        <li><a href="vote.html">Vote</a></li>
                                        <li><a href="result.html">Result</a></li>
                                         <li><a href="electioninfo.html">Elections</a></li>
                                          <li style="color:white;font-size:15px;">Candidates
						<ul class="submenu">
                                                <div class="a2"><li><a href="candidateinfo.html">information</a></li></div>
                                                <div class="a2"><li><a href="candidateregister.html">registration</a></li></div>
                                            </ul>
			</li>

			 <li class="active" style="color:white;font-size:15px;">My Account
						<ul class="submenu">
                                                <div class="a2"><li><a href="profile.html">My Profile</a></li></div>
                                                <div class="a2"><li><a href="#" id="logout">Logout</a></li></div>
                                            </ul>
			</li>  
			
                                        <li><a href="index.html#contact-section">Contact</a></li>					
              
                                    </ul>
                                </nav>
                            </div>

<div class="col-12">
                            <div class="mobile_menu d-block d-lg-none"></div>
                        </div>
                        </div>
<div class="col-xl-3 col-lg-3 d-none d-lg-block">
                            <div class="Appointment">
                             <a href="profile.html"><img style="width:40px;height:40px;border-radius:50px;margin-right:30px;"src="p1.png"></a>
                            </div>
                        </div>  
</header>
   <div class="bradcam1">   
<div class="containerprofile">
                    <form onsubmit="event.preventDefault();" id="signup-form" class="signup-form" autocomplete="off" action="">
		<h1>My Profile</h1>
		<div class="box">
		<div class="box1"><img src="p1.png">
		<br>     <br>             
       			<b>First Name:</b>
                            <input type="text" name="firstname" id="firstname">
                       	<br>
			<b>Middle Name:</b>
                            <input type="text" name="middlename" id="middlename">
                        	<br>
			<b>SurName:</b>
                            <input type="text" name="surname" id="surname">
           		</div>
                        	<br><div class="box2">
			<b>VoterId No:</b>
                            <input type="text"name="voterid" id="voteridno">
                        	<br>
			<b>Username:</b>
                            <input type="text"  name="username" id="username">
          		<br> 
		<b>Email:</b>
                            <input type="email" name="email" id="email">
                   	<br>
          <a href="#" id="updatebtn"><button>Update</button></a></div>  
                               
                      </div>
          <div id="deletecandidateform"><h5>Withdraw your candidate form</h5><a href="#" id="deletebtn"><button>Withdraw</button></a></div>
                    </form>
                </div>
   
 </div>

 <script src="./js/vendor/jquery-3.3.1.min.js"></script>
 <script>
     $(document).ready(function() {
                    var accesstoken = sessionStorage.getItem('accessToken');
                    if(accesstoken == null)
                    {
                        window.location.href="login.html";
                    }
                    var token = window.sessionStorage;
                       var authHeaders = {};
                       authHeaders.Authorization = 'Bearer ' + token.accessToken;
    
                    $.ajax({
                        type: "POST",
                        contentType: "application/json; charset=utf-8",
                        url: "http://localhost:54546/api/Account/RetrieveProfileData",
                        headers: authHeaders,
                        data: "{}",
                        dataType: "json",
                        success: function (Result) {
                            // $('#firstname').append(Result.Data.FirstName);
                             $('#firstname').val(Result.Data.FirstName);
                             $('#middlename').val(Result.Data.MiddleName);
                             $('#surname').val(Result.Data.LastName);
                            //  $('#email').val(Result.Data.FirstName);
                            // var date = Result.Data.DOB;                            
                            // var d=new Date(date.split("/").reverse().join("-"));
                            // // alert(d);
                            // var dd=d.getDate();
                            // // alert("date" +dd);
                            // var mm=d.getMonth()+1;
                            // // alert("month" +mm);
                            // var yy=d.getFullYear();
                            // var ddate = dd+"-"+mm+"-"+yy;
                            // var d1=parseInt(ddate);
                            // var m1=parseInt(mm);
                            // var y1=parseInt(yy);
                            // // alert("year" +yy);
                            // // alert(dd+"/"+mm+"/"+yy);
                            // // console.log(date);
                            // //  $('#dob').val(d);
                            // //  $('#dob').attr("value","12-6-1999");
                            // $("#dob").attr("value", d1+"-"+m1+"-"+y1);
                             $('#voteridno').val(Result.Data.VoterId);
                             $('#username').val(Result.Data.ElectorName);
                             if(Result.Data.candidateExist!=true)
                             {
                                 $("#deletecandidateform").remove();
                             }
                             $("#deletebtn").click(function(){
                                var con = confirm("Are you sure you want to Withdraw this ")
                                if(con)
                                {
                                    $.ajax({
                                        type: "POST",
                                        contentType: "application/json; charset=utf-8",
                                        url: "http://localhost:54546/api/Candidate/DeleteCandidate",
                                        headers: authHeaders,
                                        data: "{}",
                                        dataType: "json",
                                        success: function (Result) {
                                            if (Result.Data==true) {
                                                alert(Result.Message);                   
                                                location.reload(true);
                                            }
                                            else{
                                                alert("error");
                                            }
                                        }
                                    });
                                }
                             });

                             $("#updatebtn").click(function(){
                                var FirstName=$("#firstname").val();
                                var MiddleName=$("#middlename").val();
                                var LastName=$("#surname").val();
                                var ElectorName=$("#username").val()
                                // var Password=$("#password").val();
                                // var Type=2;
                                // var DOB=$("#dob").val();
                                var VoterId=$("#voteridno").val();

                                var datastring= {'FirstName':FirstName,'MiddleName':MiddleName,'LastName':LastName,'ElectorName':ElectorName, 'VoterId':VoterId};
                                if(FirstName == ''|| MiddleName == '' || LastName == '' || ElectorName == '' || VoterId == '') 
                                {
                                    if (FirstName == '') {
                                        $(".validation2").remove();
                                        $("#firstname").after("<div class='validation2' style='color:red;margin-bottom: 0px;'>Please enter your firstname</div>");
                                    }
                                    if (MiddleName == '') {
                                        $(".validation3").remove();
                                        $("#middlename").after("<div class='validation3' style='color:red;margin-bottom: 0px;'>Please enter your middlename</div>");
                                    }
                                    if (LastName == '') {
                                        $(".validation4").remove();
                                        $("#surname").after("<div class='validation4' style='color:red;margin-bottom: 0px;'>Please enter your lastname/surname</div>");
                                    }
                                    if (ElectorName == '') {
                                        $(".validation5").remove();
                                        $("#username").after("<div class='validation5' style='color:red;margin-bottom: 0px;'>Please enter your username</div>");
                                    }
                                    // if (Password == '') {
                                    //     $(".validation6").remove();
                                    //     $("#password").after("<div class='validation6' style='color:red;margin-bottom: 0px;'>Please enter your password</div>");
                                    // }
                                    // if (DOB == '') {
                                    //     $(".validation7").remove();
                                    //     $("#dob").after("<div class='validation7' style='color:red;margin-bottom: 0px;'>Please enter your date of birth</div>");
                                    // }
                                    if (VoterId == '') {
                                        $(".validation8").remove();
                                        $("#voteridno").after("<div class='validation8' style='color:red;margin-bottom: 0px;'>Please enter your voterid</div>");
                                    }
                                }
                                else{   
                                    $.ajax({
                                        type: "POST",
                                        contentType: "application/json; charset=utf-8",
                                        url: "http://localhost:54546/api/Account/SaveProfile",
                                        headers: authHeaders,
                                        data: JSON.stringify(datastring),
                                        dataType: "json",
                                        success: function (Result) {
                                            // alert(Result.Data);
                                            alert(Result.Message);
                                            location.reload(true);
                                        }
                                    });
                                }
                             });
                        }
                    });
                    $("#logout").click(function(){
                    if($("#logout").text()=='Logout')
                    {
                        sessionStorage.clear();
                        location.reload(true);
                    }
                });
    });
 </script>

<script src="js/vendor/modernizr-3.5.0.min.js"></script>
    <script src="js/vendor/jquery-1.12.4.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/isotope.pkgd.min.js"></script>
    <script src="js/ajax-form.js"></script>
    <script src="js/waypoints.min.js"></script>
    <script src="js/jquery.counterup.min.js"></script>
    <script src="js/imagesloaded.pkgd.min.js"></script>
    <script src="js/scrollIt.js"></script>
    <script src="js/jquery.scrollUp.min.js"></script>
    <script src="js/wow.min.js"></script>
    <script src="js/nice-select.min.js"></script>
    <script src="js/jquery.slicknav.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/gijgo.min.js"></script>

    <!--contact js-->
    <script src="js/contact.js"></script>
    <script src="js/jquery.ajaxchimp.min.js"></script>
    <script src="js/jquery.form.js"></script>
    <script src="js/jquery.validate.min.js"></script>
    <script src="js/mail-script.js"></script>

    <script src="js/main.js"></script>
</body>

</html>